---
id: invoke-system
title: invoke-system
sidebar_position: 14
---

# Invoke System Operation

The FHIR [system-level operation invocation](https://www.hl7.org/fhir/operations.html) allows you to invoke a custom or standard operation at the system level (not tied to any specific resource type or instance). This is done using an HTTP POST or GET request to the operation endpoint at the root level.

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
<TabItem value="cli" label="CLI" default>

Invoke the `$export` operation at the system level using the Haste Health CLI:

```bash
haste-health api invoke-system export --file params.json
```

Where `params.json` contains:

```json
{
  "resourceType": "Parameters",
  "parameter": [
    {
      "name": "_type",
      "valueString": "Patient,Observation"
    },
    {
      "name": "_since",
      "valueInstant": "2025-01-01T00:00:00Z"
    }
  ]
}
```

</TabItem>
<TabItem value="typescript" label="TypeScript Client">

Invoke a system-level operation using the TypeScript client:

```typescript
import { AsynchronousClient } from '@haste-health/client';
import { R4 } from '@haste-health/fhir-types/versions';
import { Parameters } from '@haste-health/fhir-types/r4/types';

// Assuming you have a configured client
const client: AsynchronousClient<{}> = /* ... */;

const params: Parameters = {
  resourceType: "Parameters",
  parameter: [
    {
      name: "_type",
      valueString: "Patient,Observation"
    },
    {
      name: "_since",
      valueInstant: "2025-01-01T00:00:00Z"
    }
  ]
};

const result = await client.invoke_system(
  {},
  R4,
  'export',
  params
);

console.log('Export initiated:', result);
```

</TabItem>
<TabItem value="curl" label="cURL">

Invoke the `$export` operation at the system level using cURL:

```bash
curl -X POST "https://api.haste.health/w/[tenant]/[project]/api/v1/fhir/r4/\$export" \
     -H "Content-Type: application/fhir+json" \
     -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
     -H "Prefer: respond-async" \
     -d '{
           "resourceType": "Parameters",
           "parameter": [
             {
               "name": "_type",
               "valueString": "Patient,Observation"
             },
             {
               "name": "_since",
               "valueInstant": "2025-01-01T00:00:00Z"
             }
           ]
         }'
```

</TabItem>
</Tabs>
Replace `[tenant]` with your tenant name and `[project]` with your project ID.

This command sends a POST request to invoke the `$export` operation at the system level to export Patient and Observation resources.
<div className="border border-orange-100" />





## Error Handling

If there are any issues with the request (e.g., invalid parameters, operation not supported), the server will respond with an appropriate error status code and include an `OperationOutcome` resource in the response body.

```
HTTP/1.1 400 Bad Request
Content-Type: application/fhir+json
```

```json
{
  "resourceType": "OperationOutcome",
  "issue": [
    {
      "severity": "error",
      "code": "invalid",
      "diagnostics": "Invalid _outputFormat parameter"
    }
  ]
}
```

